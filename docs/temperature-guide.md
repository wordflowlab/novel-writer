# AI 温度控制与小说创作指南

本文档解释 AI 温度参数对小说创作的影响，以及 Novel Writer 如何在编程工具环境中实现创作性补偿。

---

## 📊 什么是 AI 温度参数？

### 技术定义

**Temperature（温度）** 是大语言模型（LLM）的生成参数，控制输出的随机性和创造性：

```
温度范围：0.0 - 1.0
├─ 0.0 - 0.3  【低温】确定性、保守、重复性高
├─ 0.4 - 0.6  【中温】平衡准确性和创造性
├─ 0.7 - 0.9  【高温】创造性、多样化、意外性强
└─ 1.0       【极高温】极度随机（一般不使用）
```

### 温度对输出的影响

#### 示例：续写"他推开门"

| 温度 | 可能的输出 | 特征 |
|------|-----------|------|
| **0.2** | "看到房间里一片漆黑。" | 常见、安全、可预测 |
| **0.5** | "一股霉味扑面而来，房间里堆满了旧书。" | 有一定细节，较生动 |
| **0.8** | "月光透过破窗撒在地板上，映出斑驳的血迹。" | 富有想象力，情感浓烈 |

**关键区别**：
- **低温（编程）**："他走进房间"→ 高频词、平淡描写
- **高温（创作）**："他踏入那间久违的房间，空气中飘荡着陈年旧事的气息" → 变化多端、情感丰富

---

## 🔧 编程工具为什么用低温？

### Claude Code、Cursor 等 AI 编程助手的设计理念

#### 编程任务的核心需求
1. **准确性** > 创造性
2. **一致性** > 多样性
3. **可预测** > 意外性

#### 低温的优势（在编程场景下）

```python
# 低温生成的代码（温度 0.0-0.2）
def calculate_sum(numbers):
    return sum(numbers)  # ✅ 直接、标准、可靠

# 高温可能生成的代码（温度 0.8-1.0）
def calculate_sum(numbers):
    # 让我们用递归实现一个优雅的解法
    if not numbers:
        return 0
    return numbers[0] + calculate_sum(numbers[1:])  # ❌ 过度设计、效率低
```

**结论**：低温确保代码的**标准性、安全性、一致性**。

---

## ⚠️ 低温对小说创作的负面影响

### 实际问题表现

#### 1. 对话机械化

**低温输出** ❌：
```
"你在哪里？"张三问。
"我在家。"李四说。
"为什么不来？"张三又问。
```

**高温输出** ✅：
```
"你到底在哪？"张三的声音透过电话传来，带着掩饰不住的焦虑。
沉默。三秒后，李四才低声道："家里。"
"我等了你两小时！"张三几乎是吼出来的，"给我一个理由！"
```

#### 2. 描写扁平化

**低温输出** ❌：
```
房间很暗，他走了进去。桌子上有一本书。
```

**高温输出** ✅：
```
房间笼罩在昏黄的暮色中，唯一的光源是窗帘缝隙透进的微弱天光。
他小心翼翼地踏入，木地板发出轻微的吱嘎声。
视线扫过满是灰尘的桌面，落在那本泛黄的日记本上——
封面的字迹已经模糊，但他认得那笔迹，那是母亲的手笔。
```

#### 3. 情感缺失

**低温输出** ❌：
```
他很生气，离开了房间。
```

**高温输出** ✅：
```
他攥紧拳头，指甲嵌进掌心。
深吸一口气，转身，脚步沉重地走向门口。
手指触碰到门把手的瞬间，他停顿了一秒，
但最终还是狠狠推开门，砰的一声震得墙壁都颤了颤。
```

---

## 🚫 为什么不能直接设置温度？

### 官方限制现状

#### Claude Code
- **官方文档确认**：不支持 `temperature` 参数
- **frontmatter 字段**：仅支持 `model`、`allowed-tools`、`description` 等
- **配置系统**：无任何温度相关设置项
- **状态**：功能请求已提交（GitHub Issue #6096），未实现

#### Cursor
- **硬编码温度**：0.0（锁定）
- **用户控制**：完全不可用
- **官方回应**：有意为之，确保代码生成质量
- **状态**：多次功能请求，官方拒绝实现

#### 其他工具（Windsurf, Roo Code, Copilot 等）
- **通用情况**：普遍锁定低温度
- **原因**：编程场景优先准确性

### 技术背景

```yaml
# Claude API 支持（API 调用）
temperature: 0.7  # ✅ 支持设置

# Claude Code 斜杠命令（CLI 工具）
---
model: claude-sonnet-4-5-20250929
temperature: 0.7  # ❌ 不支持，会被忽略
---
```

**结论**：温度参数在 **API 层面存在**，但在 **CLI 工具层面未暴露**。

---

## ✅ Novel Writer 的解决方案

### 核心思路：提示工程模拟高温效果

既然无法修改温度参数，我们通过**显式指令**引导 AI 产生高温度效果：

```
低温 AI + 强化创作提示 ≈ 高温 AI 输出
```

### 实施方案

#### 方案设计

**在 `/write` 命令模板中添加"创作强化指令"模块**：
- 明确要求情感化、多样化表达
- 提供对比示例（机械 vs 生动）
- 强调感官细节、对话自然化、冲突张力
- 要求变化节奏、避免重复

#### 技术实现位置

```
templates/commands/write.md
    ↓
"写作前提醒"之后
    ↓
【创作强化指令模块】← 新增
    ↓
"根据计划创作内容"之前
```

### 创作强化指令核心内容

#### 🎨 情感与表达多样性
- **必须**创造情感丰富的内容
- **避免**模板化描写（"他皱起眉头"）
- **使用**感官细节（视听触嗅味）
- **词汇多样化**（同一情绪多种表达）

#### 💬 对话自然化
- **拒绝**说明式对话："我很生气，因为……"
- **采用**真实对话节奏：停顿、犹豫、省略
- **根据**人物性格调整语气

#### 📖 场景生动化
- **对比示例**：机械描写 vs 生动描写
- **要求**至少 3 种感官体验
- **强调**画面感和沉浸感

#### 🔥 冲突与张力
- **避免**平铺直叙："他们吵了一架"
- **制造**戏剧张力：动作、微表情、环境烘托

#### 🌊 节奏变化
- **长短句交替**
- **快慢节奏切换**（行动 vs 内心）
- **留白艺术**（不说透，留想象空间）

---

## 📋 使用指南

### 自动生效

**无需用户干预**：更新后的 `/write` 命令会自动应用创作强化指令。

### 验证效果

#### 更新前后对比

**更新前**（无创作强化）：
```
他走进房间，看到桌子上有一本书。他拿起书，翻开看了看。
```

**更新后**（有创作强化）：
```
他推开那扇吱嘎作响的房门，空气中弥漫着尘埃的气味。
昏暗的光线下，视线落在桌面那本泛黄的书册上。
他走近，指尖拂过粗糙的封面，感受到岁月刻下的痕迹。
翻开扉页，熟悉的笔迹映入眼帘——是父亲的手书。
```

### 适用场景

| 命令 | 是否应用创作强化 | 原因 |
|------|----------------|------|
| `/write` | ✅ 是 | 唯一的创作命令，需要高创造性 |
| `/plan` | ❌ 否 | 规划文档，需要逻辑清晰、结构化 |
| `/analyze` | ❌ 否 | 质量分析，需要客观、准确 |
| `/checklist` | ❌ 否 | 验证清单，需要系统性、一致性 |
| `/specify` | ❌ 否 | 定义规格，需要明确、无歧义 |

**原则**：
- **创作类命令** → 模拟高温（增强创造性）
- **分析/规划类** → 保持低温（确保准确性）

---

## 🧪 效果验证方法

### 定性评估

使用 `/write` 创作一章后，检查以下维度：

| 维度 | 低温特征（❌） | 高温特征（✅） |
|------|-------------|-------------|
| **对话** | "你好""我很好"式对话 | 有停顿、情绪、个性的对话 |
| **描写** | "房间很大""天气很冷" | 感官细节、具体画面感 |
| **情感** | 直接陈述"他很生气" | 微表情、肢体语言、环境烘托 |
| **节奏** | 句式单一、平铺直叙 | 长短交替、张弛有度 |
| **词汇** | 高频重复词（"然后""于是"） | 词汇丰富、表达多样 |

### 定量指标

```bash
# 使用 /analyze 命令查看质量评分
/analyze --type=content

# 关注以下指标
- 内容质量 > 7.5/10
- 文字水准 > 8/10
- 读者体验 > 8/10
```

---

## 💡 最佳实践

### 1. 信任自动化

✅ **推荐做法**：
```bash
# 直接使用，无需额外参数
/write 第3章：初次相遇
```

❌ **不推荐做法**：
```bash
# 手动添加"请生动描写"等提示（已内置）
/write 第3章 请使用生动的描写，情感要丰富……
```

**原因**：创作强化指令已内置，重复添加会产生冗余。

### 2. 个性化增强（可选）

如需特定风格，可在提示中补充：

```bash
/write 第5章：紧张对峙

本章要求：
- 风格：紧张悬疑，节奏快
- 对话：短促、有冲突感
- 描写：聚焦微表情和肢体动作
```

### 3. 配合其他功能

```bash
# 1. 确保规格定义明确（低温、结构化）
/specify 定义故事规格……

# 2. 制定创作计划（低温、逻辑性）
/plan 制定章节架构……

# 3. 执行创作（高温模拟、创造性）
/write 第1章

# 4. 质量分析（低温、客观性）
/analyze
```

---

## 🔬 技术原理

### 为什么提示工程可以补偿温度？

#### 温度的本质

温度参数影响模型的 **token 选择概率分布**：

```
低温（0.2）：选择最高概率词
├─ "他很生气" (p=0.85) ← 选择
├─ "他十分愤怒" (p=0.10)
└─ "他怒不可遏" (p=0.05)

高温（0.8）：增加低概率词的机会
├─ "他很生气" (p=0.50)
├─ "他十分愤怒" (p=0.30) ← 可能选择
└─ "他怒不可遏" (p=0.20) ← 可能选择
```

#### 提示工程的作用

通过**显式指令**改变概率分布的权重：

```
提示："避免使用'很'，使用具体动作和表情描写情绪"

低温（0.2）+ 强化提示：
├─ "他攥紧拳头，脸色铁青" (p=0.70) ← 选择
├─ "他咬紧牙关，青筋暴起" (p=0.20)
└─ "他很生气" (p=0.10) ← 被抑制
```

**结果**：即使在低温下，通过提示引导也能输出更具创造性的内容。

### 局限性

提示工程**不能完全替代**高温，但可以：

| 维度 | 高温 API | 提示工程模拟 | 差距 |
|------|---------|-------------|------|
| **词汇多样性** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 略低 |
| **句式变化** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 略低 |
| **意外性/创新** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | 明显降低 |
| **情感丰富度** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 接近 |
| **一致性控制** | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 提示更强 |

**结论**：提示工程可补偿 **70-80%** 的高温效果，同时保持更好的一致性。

---

## 🔮 未来展望

### 官方功能请求

我们已向相关平台提交功能请求：

- **Claude Code**: [GitHub Issue #6096](https://github.com/anthropics/claude-code/issues/6096)
- **Cursor**: 社区论坛多次请求

如果未来工具支持温度参数，我们将：
1. 在 frontmatter 中添加 `temperature: 0.8` 字段
2. 保留创作强化提示作为补充（双重保障）
3. 提供配置选项供用户选择

### 备选方案探索

- **自定义 API 集成**：绕过 CLI，直接调用 Claude API
- **本地 LLM 方案**：使用支持温度控制的本地模型（如 Ollama）
- **混合方案**：规划用 CLI，创作用 API

---

## ❓ 常见问题

### Q1: 为什么不直接使用 Claude API 而用 Claude Code？

**A**: Claude Code 提供：
- 文件读写权限管理
- 斜杠命令系统
- 项目上下文管理
- 更好的开发体验

切换到纯 API 会失去这些便利性。

### Q2: 创作强化指令会让 AI 变得"啰嗦"吗？

**A**: 不会。指令要求的是**质量**，不是**字数**：
- ✅ "用微表情表达情绪" → 提升细节丰富度
- ❌ "写得越多越好" → 会导致啰嗦

实际测试中，字数略有增加（10-15%），但信息密度和可读性提升更明显。

### Q3: 能否为不同章节设置不同"温度"？

**A**: 可以通过提示微调：

```bash
# 行动场面（希望快节奏、简洁）
/write 第10章 【行动】要求：短句、快节奏、聚焦动作

# 情感戏（希望细腻、深入）
/write 第11章 【情感】要求：长句、细腻、深入内心描写
```

### Q4: 这个方案适用于所有 AI 平台吗？

**A**: 是的，因为这是**纯提示方案**，与平台无关：
- ✅ Claude Code
- ✅ Cursor
- ✅ Windsurf
- ✅ Roo Code
- ✅ Copilot
- ✅ 其他任何支持自定义命令的工具

---

## 📚 相关文档

- [命令详解](commands.md) - 所有命令的完整说明
- [工作流程](workflow.md) - 创作流程最佳实践
- [最佳实践](best-practices.md) - 实战经验总结
- [技术架构](tech/architecture.md) - 系统设计原理

---

## 📝 更新日志

| 版本 | 日期 | 更新内容 |
|------|------|---------|
| v0.16.4 | 2025-10-12 | 初版发布：创建温度控制指南，实施提示工程方案 |

---

**总结**：虽然无法直接控制温度参数，但通过精心设计的创作强化指令，Novel Writer 在低温环境下实现了 **70-80% 的高温效果补偿**，为小说创作提供了情感丰富、表达多样、细节生动的输出质量。 ✨
