# /analyze å‘½ä»¤ - æ™ºèƒ½ç»¼åˆéªŒè¯åˆ†æ
# Gemini CLI æ ¼å¼ï¼ˆTOMLï¼‰

[analyze]
description = "æ™ºèƒ½åˆ†æï¼šæ ¹æ®åˆ›ä½œé˜¶æ®µè‡ªåŠ¨é€‰æ‹©æ¡†æ¶åˆ†ææˆ–å†…å®¹åˆ†æ"
category = "methodology"
execute_immediately = false
confirmation_message = "å³å°†æ‰§è¡Œæ™ºèƒ½ç»¼åˆåˆ†æã€‚"

[analyze.parameters.script]
type = "script_path"
value = ".specify/scripts/bash/check-analyze-stage.sh"
value_ps = ".specify\\scripts\\powershell\\check-analyze-stage.ps1"

[analyze.parameters.type]
type = "option"
options = ["auto", "framework", "content"]
default = "auto"
description = "åˆ†æç±»å‹ï¼šauto(è‡ªåŠ¨åˆ¤æ–­)/framework(æ¡†æ¶åˆ†æ)/content(å†…å®¹åˆ†æ)"

[analyze.prompts.main]
template = """
å¯¹å°è¯´é¡¹ç›®è¿›è¡Œæ™ºèƒ½åŒ–ç»¼åˆåˆ†æã€‚æ ¹æ®å½“å‰åˆ›ä½œé˜¶æ®µï¼Œè‡ªåŠ¨é€‰æ‹©æ‰§è¡Œ**æ¡†æ¶ä¸€è‡´æ€§åˆ†æ**ï¼ˆwrite ä¹‹å‰ï¼‰æˆ–**å†…å®¹è´¨é‡åˆ†æ**ï¼ˆwrite ä¹‹åï¼‰ã€‚

## æ ¸å¿ƒç†å¿µ

**ä¸€ä¸ªå‘½ä»¤ï¼ŒåŒé‡æ™ºèƒ½**ï¼š
- ğŸ“ **æ¡†æ¶åˆ†æ**ï¼šåœ¨å†™ä½œå‰éªŒè¯è§„æ ¼ã€è®¡åˆ’ã€ä»»åŠ¡çš„ä¸€è‡´æ€§
- ğŸ“ **å†…å®¹åˆ†æ**ï¼šåœ¨å†™ä½œåéªŒè¯å·²å®Œæˆå†…å®¹çš„è´¨é‡å’Œç¬¦åˆåº¦

## æ‰§è¡Œæµç¨‹

### 1. æ™ºèƒ½é˜¶æ®µæ£€æµ‹

è¿è¡Œè„šæœ¬è·å–å½“å‰åˆ›ä½œçŠ¶æ€ï¼Œè§£æè¿”å›çš„ JSONï¼š

```json
{
  "analyze_type": "framework|content",
  "chapter_count": 0,
  "has_spec": true,
  "has_plan": true,
  "has_tasks": true,
  "story_dir": "/path/to/story",
  "reason": "åŸå› è¯´æ˜"
}
```

### 2. å†³ç­–é€»è¾‘

- ç”¨æˆ·æŒ‡å®š `--type=framework` â†’ å¼ºåˆ¶æ¡†æ¶åˆ†æ
- ç”¨æˆ·æŒ‡å®š `--type=content` â†’ å¼ºåˆ¶å†…å®¹åˆ†æ
- ç« èŠ‚æ•° = 0 â†’ æ¡†æ¶åˆ†æ
- ç« èŠ‚æ•° < 3 â†’ æ¡†æ¶åˆ†æ
- ç« èŠ‚æ•° â‰¥ 3 â†’ å†…å®¹åˆ†æ

### 3. æ‰§è¡Œå¯¹åº”åˆ†æ

æ ¹æ®å†³ç­–ç»“æœï¼Œæ‰§è¡Œæ¡†æ¶åˆ†ææˆ–å†…å®¹åˆ†æã€‚

---

## æ¨¡å¼Aï¼šæ¡†æ¶ä¸€è‡´æ€§åˆ†æ

**ç›®æ ‡**ï¼šåœ¨å†™ä½œå‰éªŒè¯å‡†å¤‡å·¥ä½œæ˜¯å¦å……åˆ†ã€‚

### A1. åŠ è½½åŸºå‡†æ–‡æ¡£
- å®ªæ³•æ–‡ä»¶ï¼š`.specify/memory/novel-constitution.md`
- è§„æ ¼æ–‡ä»¶ï¼š`stories/*/specification.md`
- è®¡åˆ’æ–‡ä»¶ï¼š`stories/*/creative-plan.md`
- ä»»åŠ¡æ–‡ä»¶ï¼š`stories/*/tasks.md`

### A2. è¦†ç›–ç‡åˆ†æ

```markdown
## è¦†ç›–ç‡åˆ†ææŠ¥å‘Š

### P0 éœ€æ±‚è¦†ç›–
- [éœ€æ±‚1ï¼šä¸»è§’æˆé•¿çº¿] â†’ âœ… è®¡åˆ’ç¬¬3ç« æ®µã€ä»»åŠ¡#5-8
- [éœ€æ±‚2ï¼šåæ´¾è®¾å®š] â†’ âš ï¸ è®¡åˆ’ä¸­æåŠï¼Œä½†æ— å…·ä½“ä»»åŠ¡
- [éœ€æ±‚3ï¼šæ‚¬å¿µè®¾ç½®] â†’ âŒ è®¡åˆ’å’Œä»»åŠ¡ä¸­å‡æœªè¦†ç›–
```

### A3. ä¸€è‡´æ€§æ£€æŸ¥

```markdown
## ä¸€è‡´æ€§æ£€æŸ¥æŠ¥å‘Š

### è§„æ ¼ â†” è®¡åˆ’
- âœ… ä¸»é¢˜è¡¨è¾¾ä¸€è‡´
- âš ï¸ è§„æ ¼è¦æ±‚"å¿«èŠ‚å¥"ï¼Œä½†è®¡åˆ’å‰5ç« èŠ‚å¥è¾ƒæ…¢

### è®¡åˆ’ â†” ä»»åŠ¡
- âœ… æ‰€æœ‰è®¡åˆ’ç« èŠ‚éƒ½æœ‰ä»»åŠ¡
- âŒ è®¡åˆ’è¦æ±‚ç¬¬5ç« æ˜¯é«˜æ½®ï¼Œä½†ä»»åŠ¡æ ‡æ³¨ä¸º"è¿‡æ¸¡ç« èŠ‚"
```

### A4. å‡†å¤‡å°±ç»ªè¯„ä¼°

```markdown
## å‡†å¤‡å°±ç»ªè¯„ä¼°

### å¿…è¦æ¡ä»¶ (P0)
- [x] è§„æ ¼å®Œæ•´ä¸”æ˜ç¡®
- [x] è®¡åˆ’è¦†ç›–æ‰€æœ‰ P0 éœ€æ±‚
- [ ] ä»»åŠ¡åˆ†è§£å®Œæ•´ï¼ˆç¼ºå°‘3ä¸ªç« èŠ‚çš„ä»»åŠ¡ï¼‰
- [ ] æ— è‡´å‘½é€»è¾‘çŸ›ç›¾ï¼ˆå‘ç°2å¤„ï¼‰

### æ€»ä½“è¯„åˆ†ï¼š6/10

**å»ºè®®**ï¼š
1. ğŸ”´ å¿…é¡»ä¿®å¤ï¼šè¡¥å……ç¬¬10-12ç« çš„ä»»åŠ¡
2. ğŸ”´ å¿…é¡»ä¿®å¤ï¼šè§£å†³æ—¶é—´çº¿å’Œè§’è‰²èƒ½åŠ›çŸ›ç›¾

**ç»“è®º**ï¼šå½“å‰**ä¸å»ºè®®å¼€å§‹å†™ä½œ**ï¼Œè¯·å…ˆè§£å†³ P0 é—®é¢˜ã€‚
```

---

## æ¨¡å¼Bï¼šå†…å®¹è´¨é‡åˆ†æ

**ç›®æ ‡**ï¼šå¯¹å·²å®Œæˆçš„å†…å®¹è¿›è¡Œç»¼åˆè´¨é‡éªŒè¯ã€‚

### B1. åŠ è½½éªŒè¯åŸºå‡†
- å®ªæ³•æ–‡ä»¶ï¼š`.specify/memory/novel-constitution.md`
- è§„æ ¼æ–‡ä»¶ï¼š`stories/*/specification.md`
- è®¡åˆ’æ–‡ä»¶ï¼š`stories/*/creative-plan.md`
- ä»»åŠ¡åˆ—è¡¨ï¼š`stories/*/tasks.md`
- **å·²å®Œæˆå†…å®¹**ï¼š`stories/*/content/*.md`

### B2. å®ªæ³•åˆè§„æ€§æ£€æŸ¥

```markdown
## å®ªæ³•åˆè§„æ€§æŠ¥å‘Š

### æ ¸å¿ƒä»·å€¼è§‚æ£€æŸ¥
- [x] ä»·å€¼è§‚åŸåˆ™1ï¼šç§¯æå‘ä¸Šçš„ä¸»é¢˜ âœ…
- [x] ä»·å€¼è§‚åŸåˆ™2ï¼šé¿å…ä½ä¿—å†…å®¹ âœ…
- [ ] ä»·å€¼è§‚åŸåˆ™3ï¼šå°Šé‡æ–‡åŒ–ä¼ ç»Ÿ âš ï¸ ç¬¬7ç« æœ‰äº‰è®®æè¿°

### è´¨é‡æ ‡å‡†éªŒè¯
- é€»è¾‘ä¸€è‡´æ€§ï¼š8/10 âš ï¸ ç¬¬3ç« å’Œç¬¬6ç« æœ‰å°çŸ›ç›¾
- äººç‰©é¥±æ»¡åº¦ï¼š7/10
- æ–‡å­—æ°´å‡†ï¼š8/10

**æ€»ä½“è¯„åˆ†ï¼š8/10**
```

### B3. è§„æ ¼ç¬¦åˆåº¦åˆ†æ

```markdown
## è§„æ ¼ç¬¦åˆåº¦åˆ†æ

### æ ¸å¿ƒéœ€æ±‚è¦†ç›–
#### P0ï¼ˆå¿…é¡»åŒ…å«ï¼‰
- [éœ€æ±‚1ï¼šçˆ¶å­å†²çª] â†’ âœ… ç¬¬2-4ç« å……åˆ†å±•ç°
- [éœ€æ±‚2ï¼šæ‚¬å¿µè®¾ç½®] â†’ âš ï¸ ç¬¬5ç« æ‚¬å¿µä¸è¶³
- [éœ€æ±‚3ï¼šåæ´¾ç«‹ä½“] â†’ âŒ åæ´¾å°šæœªæ­£å¼å‡ºåœº

è¦†ç›–ç‡ï¼š67% (2/3)

**æ€»ä½“è¯„åˆ†ï¼š7/10**
```

### B4. å†…å®¹è´¨é‡åˆ†æ

```markdown
## å†…å®¹è´¨é‡åˆ†æ

### æ–‡æœ¬ç»Ÿè®¡
- æ€»å­—æ•°ï¼š45,230 å­—
- å¹³å‡ç« èŠ‚é•¿åº¦ï¼š6,461 å­—
- å®Œæˆè¿›åº¦ï¼š35%ï¼ˆ7/20 ç« ï¼‰

### æŠ€æœ¯é—®é¢˜
#### é€»è¾‘é—®é¢˜
1. ç¬¬3ç« ï¼šè§’è‰²æåˆ°"ä¸‰å¹´å‰çš„äº‹"ï¼Œä½†æ—¶é—´çº¿æ˜¾ç¤ºåªè¿‡äº†ä¸¤å¹´
2. ç¬¬6ç« ï¼šä¸»è§’ä½¿ç”¨äº†ç¬¬2ç« æ˜ç¡®è¯´"ä¸ä¼š"çš„èƒ½åŠ›

#### äººç‰©ä¸€è‡´æ€§
1. ä¸»è§’åœ¨ç¬¬2ç« å’Œç¬¬5ç« å¯¹åŒä¸€ç±»äº‹ä»¶ååº”çŸ›ç›¾

### äº®ç‚¹è¯†åˆ«
1. ç¬¬1ç« ï¼šå¼€ç¯‡é’©å­è®¾è®¡ç²¾å¦™ï¼Œå¼•å…¥è‡ªç„¶
2. ç¬¬4ç« ï¼šçˆ¶å­å¯¹è¯å±‚æ¬¡ä¸°å¯Œï¼Œæƒ…æ„ŸçœŸæŒš

**è´¨é‡è¯„åˆ†ï¼š7.5/10**
```

### B5. ç”Ÿæˆæ”¹è¿›å»ºè®®

```markdown
## æ”¹è¿›å»ºè®®

### ç´§æ€¥ä¿®å¤ï¼ˆP0ï¼‰
1. **æ—¶é—´çº¿çŸ›ç›¾**
   - å½±å“ï¼šç ´åè¯»è€…ä¿¡ä»»
   - å»ºè®®ï¼šç»Ÿä¸€ç¬¬3ç« å’Œç¬¬6ç« çš„æ—¶é—´è¡¨è¿°
   - ä½ç½®ï¼šç¬¬3ç« ç¬¬2èŠ‚ï¼Œç¬¬6ç« ç¬¬4èŠ‚

2. **è§’è‰²èƒ½åŠ›çŸ›ç›¾**
   - å½±å“ï¼šä¸¥é‡å½±å“äººç‰©å¯ä¿¡åº¦
   - å»ºè®®ï¼šåœ¨ç¬¬4-5ç« ä¹‹é—´å¢åŠ "å­¦ä¹ æ­¦åŠŸ"çš„è¿‡æ¸¡æƒ…èŠ‚
   - ä½ç½®ï¼šç¬¬2ç« ç¬¬5èŠ‚ï¼Œç¬¬6ç« ç¬¬3èŠ‚

### ä¼˜åŒ–å»ºè®®ï¼ˆP1ï¼‰
1. **ç¬¬5ç« æ‚¬å¿µä¸è¶³**
   - å½“å‰ï¼šç¬¬5ç« ç»“å°¾å¹³æ·¡ï¼Œç¼ºå°‘é’©å­
   - å»ºè®®ï¼šåœ¨ç»“å°¾å¢åŠ ä¸€ä¸ªæ„å¤–äº‹ä»¶æˆ–ä¿¡æ¯
   - é¢„æœŸæ•ˆæœï¼šæå‡è¯»è€…ç•™å­˜ç‡
```

### B6. ç”ŸæˆéªŒè¯æŠ¥å‘Š

åˆ›å»º `stories/*/analysis-report.md`ï¼š

```markdown
# ä½œå“åˆ†ææŠ¥å‘Š

## æ‘˜è¦
- åˆ†ææ—¥æœŸï¼š2025-10-01
- åˆ†æèŒƒå›´ï¼šç¬¬1-7ç« 
- æ€»ä½“è¯„åˆ†ï¼š7.5/10
- å»ºè®®è¡ŒåŠ¨ï¼šç»§ç»­åˆ›ä½œï¼Œæ‰¹é‡ä¿®è®¢å‰7ç« 

## æ ¸å¿ƒæŒ‡æ ‡
| ç»´åº¦ | å¾—åˆ† | è¯´æ˜ |
|------|------|------|
| å®ªæ³•åˆè§„ | 8/10 | ä»·å€¼è§‚æ­£ç¡®ï¼Œé£æ ¼ä¸€è‡´ |
| è§„æ ¼ç¬¦åˆ | 7/10 | P0éœ€æ±‚è¦†ç›–67% |
| å†…å®¹è´¨é‡ | 7.5/10 | æœ‰2å¤„é€»è¾‘é—®é¢˜éœ€ä¿®å¤ |

**å¹³å‡åˆ†ï¼š7.7/10**
```

---

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå‡†å¤‡å¼€å§‹å†™ä½œ

```
ç”¨æˆ·ï¼š/analyze
AIï¼šæ£€æµ‹åˆ°æ— ç« èŠ‚å†…å®¹ï¼Œæ‰§è¡Œæ¡†æ¶ä¸€è‡´æ€§åˆ†æ...

ã€è¦†ç›–ç‡åˆ†æã€‘
âš ï¸ è§„æ ¼éœ€æ±‚"åæ´¾è®¾å®š"æ— å¯¹åº”ä»»åŠ¡
âŒ è®¡åˆ’ç¬¬10-12ç« ç¼ºå°‘ä»»åŠ¡åˆ†è§£

ã€å‡†å¤‡è¯„åˆ†ã€‘6/10
å»ºè®®ï¼šä¿®å¤ä¸Šè¿°é—®é¢˜åå†å¼€å§‹å†™ä½œ
```

### åœºæ™¯2ï¼šå®Œæˆéƒ¨åˆ†ç« èŠ‚

```
ç”¨æˆ·ï¼š/analyze
AIï¼šæ£€æµ‹åˆ°å·²å®Œæˆ 7 ç« ï¼Œæ‰§è¡Œå†…å®¹è´¨é‡åˆ†æ...

ã€å®ªæ³•åˆè§„ã€‘8/10 âœ…
ã€è§„æ ¼ç¬¦åˆã€‘7/10 âš ï¸
ã€å†…å®¹è´¨é‡ã€‘7.5/10 âš ï¸ æœ‰2å¤„é€»è¾‘é—®é¢˜

ã€å»ºè®®ã€‘ï¼šä¿®å¤P0é—®é¢˜åï¼Œç»§ç»­åˆ›ä½œç¬¬8-10ç« 
```

---

**è®°ä½**ï¼š**ä¸€ä¸ªå‘½ä»¤ï¼Œæ™ºèƒ½åŒæ¨¡ï¼Œå…‹åˆ¶è€Œå¼ºå¤§ã€‚analyze çš„ç›®çš„æ˜¯è®©ä½œå“æ›´å¥½ï¼Œæ— è®ºæ˜¯åœ¨å†™ä½œå‰è¿˜æ˜¯å†™ä½œåã€‚**
"""

[analyze.analysis_dimensions]
dimensions = [
    "åˆè§„æ€§",
    "ä¸€è‡´æ€§",
    "å®Œæ•´æ€§",
    "è´¨é‡æ€§",
    "åˆ›æ–°æ€§",
    "å¯è¯»æ€§",
    "å¯è¡Œæ€§"
]

[analyze.outputs]
report_path = "stories/{story_name}/analysis-report.md"
format = "markdown"

[analyze.modes]
framework = "æ¡†æ¶ä¸€è‡´æ€§åˆ†æï¼ˆwrite ä¹‹å‰ï¼‰"
content = "å†…å®¹è´¨é‡åˆ†æï¼ˆwrite ä¹‹åï¼‰"
auto = "æ™ºèƒ½åˆ¤æ–­æ¨¡å¼"
